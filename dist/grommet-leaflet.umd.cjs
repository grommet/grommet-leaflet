(function(l,n){typeof exports=="object"&&typeof module<"u"?n(exports,require("/home/runner/work/grommet-leaflet/grommet-leaflet/node_modules/react/jsx-runtime.js"),require("react"),require("prop-types"),require("styled-components"),require("/home/runner/work/grommet-leaflet/grommet-leaflet/node_modules/grommet/es6/index.js"),require("/home/runner/work/grommet-leaflet/grommet-leaflet/node_modules/grommet/utils/index.js"),require("/home/runner/work/grommet-leaflet/grommet-leaflet/node_modules/react-leaflet/lib/index.js"),require("/home/runner/work/grommet-leaflet/grommet-leaflet/node_modules/leaflet/dist/leaflet-src.js"),require("/home/runner/work/grommet-leaflet/grommet-leaflet/node_modules/grommet-icons/es6/index.js"),require("/home/runner/work/grommet-leaflet/grommet-leaflet/node_modules/protomaps/dist/protomaps.module.js"),require("/home/runner/work/grommet-leaflet/grommet-leaflet/node_modules/@react-leaflet/core/lib/index.js"),require("/home/runner/work/grommet-leaflet/grommet-leaflet/node_modules/react-dom/server.browser.js"),require("/home/runner/work/grommet-leaflet/grommet-leaflet/node_modules/uuid/dist/esm-browser/index.js"),require("/home/runner/work/grommet-leaflet/grommet-leaflet/node_modules/leaflet.markercluster/dist/leaflet.markercluster-src.js")):typeof define=="function"&&define.amd?define(["exports","/home/runner/work/grommet-leaflet/grommet-leaflet/node_modules/react/jsx-runtime.js","react","prop-types","styled-components","/home/runner/work/grommet-leaflet/grommet-leaflet/node_modules/grommet/es6/index.js","/home/runner/work/grommet-leaflet/grommet-leaflet/node_modules/grommet/utils/index.js","/home/runner/work/grommet-leaflet/grommet-leaflet/node_modules/react-leaflet/lib/index.js","/home/runner/work/grommet-leaflet/grommet-leaflet/node_modules/leaflet/dist/leaflet-src.js","/home/runner/work/grommet-leaflet/grommet-leaflet/node_modules/grommet-icons/es6/index.js","/home/runner/work/grommet-leaflet/grommet-leaflet/node_modules/protomaps/dist/protomaps.module.js","/home/runner/work/grommet-leaflet/grommet-leaflet/node_modules/@react-leaflet/core/lib/index.js","/home/runner/work/grommet-leaflet/grommet-leaflet/node_modules/react-dom/server.browser.js","/home/runner/work/grommet-leaflet/grommet-leaflet/node_modules/uuid/dist/esm-browser/index.js","/home/runner/work/grommet-leaflet/grommet-leaflet/node_modules/leaflet.markercluster/dist/leaflet.markercluster-src.js"],n):(l=typeof globalThis<"u"?globalThis:l||self,n(l["grommet-leaflet"]={},l.jsxRuntime_js,l.React,l.PropTypes,l.styled,l.index_js$1,l.index_js,l.index_js$2,l.L,l.index_js$3,l.protomaps_module_js,l.index_js$4,l.ReactDOMServer,l.index_js$5))})(this,function(l,n,u,a,s,f,w,x,v,B,M,k,q,V){"use strict";const S=o=>{let e={};return o.forEach(r=>{e=w.deepMerge(e,r)}),e},Y=s(f.Box)`
  // translate to re-align with leaflet div
  transform: translateX(-35%);
  &:hover {
    transform: translateX(-35%) scale(1.1);
    transition: transform 0.4s;
  }
`,P=s(f.Text)`
  // multiplier of font-size, for tighter alignment
  line-height: 1rem;
`,z=({cluster:o,kind:e="default",size:r="medium",...i})=>{var c,g,p,h,W,X,A,K,J,F,H,U,Q;const t=u.useContext(s.ThemeContext),m=S([(p=(g=(c=t==null?void 0:t.map)==null?void 0:c.cluster)==null?void 0:g.size)==null?void 0:p.medium,(X=(W=(h=t==null?void 0:t.map)==null?void 0:h.cluster)==null?void 0:W.size)==null?void 0:X[r],(K=(A=t==null?void 0:t.map)==null?void 0:A.cluster)==null?void 0:K.default,(F=(J=t==null?void 0:t.map)==null?void 0:J.cluster)==null?void 0:F[e]]),d=o.getChildCount(),C=(Q=(U=(H=t==null?void 0:t.map)==null?void 0:H.cluster)==null?void 0:U[e])==null?void 0:Q.icon,b=d;return n.jsxs(Y,{...m==null?void 0:m.container,...i,children:[C,n.jsx(P,{...m==null?void 0:m.label,children:b})]})};z.propTypes={cluster:a.object,kind:a.string,size:a.string};const O=({locations:o})=>{const e=v.latLngBounds();return o.features?o.features.forEach(r=>{var i,t;e.extend([(i=r.geometry)==null?void 0:i.coordinates[0],(t=r.geometry)==null?void 0:t.coordinates[1]])}):o.forEach(r=>{e.extend([r==null?void 0:r[0],r==null?void 0:r[1]])}),e},j=1.5,L=({locations:o})=>{const e=x.useMap(),r=o&&O({locations:o}),[i,t]=u.useState(!1);return u.useEffect(()=>{r&&!i&&(JSON.stringify(r._northEast)===JSON.stringify(r._southWest)||e.flyToBounds(r,{duration:j}))},[r,e,i]),u.useEffect(()=>{t(!0)},[]),n.jsx(f.Box,{className:"leaflet-bottom leaflet-right",children:n.jsx(f.Box,{className:"leaflet-control",children:n.jsxs(f.Box,{elevation:"large",round:"medium",background:"background",children:[n.jsx(f.Button,{a11yTitle:"Zoom in",icon:n.jsx(B.Add,{}),onClick:m=>{m.preventDefault(),e.zoomIn()}}),n.jsx(f.Button,{a11yTitle:"Zoom out",icon:n.jsx(B.Subtract,{}),onClick:m=>{m.preventDefault(),e.zoomOut()}}),n.jsx(f.Box,{border:{color:"border-weak",side:"top"},children:r&&n.jsx(f.Button,{a11yTitle:"Zoom to data",icon:n.jsx(B.Globe,{}),onClick:m=>{m.preventDefault(),e.flyToBounds(r,{duration:1.5})}})})]})})})};L.propTypes={locations:a.oneOfType([a.array,a.object])};const y={default:{container:{align:"center",justify:"center",background:"background-front",border:{color:"border",size:"small"},elevation:"medium",flex:!1,round:"full"}}},N={pin:{...w.deepMerge(y,{default:{container:{height:{min:"25px",max:"25px"},width:{min:"25px",max:"25px"}}}})},cluster:{...y,size:{small:{container:{height:{min:"36px",max:"36px"},width:{min:"36px",max:"36px"}},label:{size:"small"}},medium:{container:{direction:"row-reverse",gap:"xxsmall",height:{min:"48px",max:"48px"},width:{min:"48px",max:"48px"}},label:{color:"text-strong",size:"medium",weight:500}},large:{container:{direction:"row-reverse",gap:"xxsmall",height:{min:"54px",max:"54px"},width:{min:"54px",max:"54px"}},label:{size:"medium"}}}},popup:{background:"background-front",border:{color:"border-weak",size:"xsmall"},gap:"xsmall",margin:"none",pad:"small",round:"xsmall"},tiles:{}},$=({...o},e)=>{const r=M.leafletLayer({paint_rules:o.paintRules,...o});return k.createElementObject(r,e)},_=k.createTileLayerComponent($,k.updateGridLayer),G=({attribution:o,url:e,format:r,...i})=>{var d;const t=u.useContext(s.ThemeContext);let m=n.jsx(x.TileLayer,{attribution:o,url:e,...i});return r==="pmtiles"&&(m=n.jsx(_,{attribution:o,url:e,paintRules:((d=t.map)==null?void 0:d.tiles)&&M.paintRules({...M.light,...t.map.tiles}),...i})),m};G.propTypes={attribution:a.string,url:a.string.isRequired,format:a.oneOf(["pmtiles"])};const R=s(x.MapContainer)`
  ${({theme:o})=>{var e,r;return`
      ${(r=(e=o==null?void 0:o.global)==null?void 0:e.font)!=null&&r.family?`font-family: ${o.global.font.family};`:""}
      height: 100%;
    `}}
`,Z=u.forwardRef(({center:o=[0,0],children:e,maxZoom:r=20,minZoom:i=3,scrollWheelZoom:t=!0,tileLayer:m,theme:d,zoom:C=1,zoomControl:b=!1,...c},g)=>{const p=u.useContext(s.ThemeContext),h=w.deepMerge(p,{map:w.deepMerge(N,d)});return n.jsx(s.ThemeContext.Provider,{value:h,children:n.jsxs(R,{attributionControl:!1,center:o,ref:g,scrollWheelZoom:t,maxZoom:r,minZoom:i,zoom:C,zoomControl:b,...c,children:[n.jsx(x.AttributionControl,{position:"bottomright",prefix:!1}),n.jsx(G,{attribution:m.attribution,url:m.url,format:m.format,...m}),e]})})});Z.propTypes={center:a.array,children:a.any,scrollWheelZoom:a.string||a.bool,maxZoom:a.number,minZoom:a.number,tileLayer:a.shape({attribution:a.string,url:a.string.isRequired,format:a.oneOf(["pmtiles"])}).isRequired,theme:a.object,zoom:a.number,zoomControl:a.bool};const D=({icon:o,popup:e,...r})=>{var d;const i=u.useContext(s.ThemeContext),t=(d=o==null?void 0:o.props)==null?void 0:d.kind,m=e?n.jsx(x.Popup,{children:n.jsx(T,{children:e})}):void 0;return n.jsx(x.Marker,{icon:v.divIcon({className:"grommet-marker",html:q.renderToString(n.jsx(s.ThemeContext.Provider,{value:i,children:o||n.jsx(E,{})}))}),kind:t,...r,children:m},V.v4())};D.propTypes={icon:a.node,popup:a.node};const ee=({...o},e)=>{const r=new v.MarkerClusterGroup({showCoverageOnHover:!1,zoomToBoundsOnClick:!1,...o});return k.createElementObject(r,k.extendContext(e,{layerContainer:r}))},re=k.createPathComponent(ee),I=({icon:o,popup:e,...r})=>{const i=u.useContext(s.ThemeContext);return n.jsx(re,{iconCreateFunction:t=>{if(e){const m=t.bindPopup(q.renderToString(n.jsx(s.ThemeContext.Provider,{value:i,children:n.jsx(T,{children:e({cluster:t})})})));t.on("click",()=>{m.openPopup()})}return v.divIcon({className:"grommet-cluster-group",html:q.renderToString(n.jsx(s.ThemeContext.Provider,{value:i,children:o?u.cloneElement(o({cluster:t}),{cluster:t}):n.jsx(z,{cluster:t})}))})},...r})};I.propTypes={icon:a.func,popup:a.func};const oe=s(f.Box)`
  // to create the pin shape
  border-bottom-right-radius: 0;
  // translate to re-align with leaflet div
  transform: rotate(45deg) translateX(-35%);
  &:hover {
    transform: rotate(45deg) translateX(-35%) scale(1.1);
    transition: transform 0.4s;
  }
`,E=({kind:o="default"})=>{var t,m,d,C,b,c,g,p,h;const e=u.useContext(s.ThemeContext),r=S([(d=(m=(t=e==null?void 0:e.map)==null?void 0:t.pin)==null?void 0:m.default)==null?void 0:d.container,(c=(b=(C=e==null?void 0:e.map)==null?void 0:C.pin)==null?void 0:b[o])==null?void 0:c.container]);let i=(h=(p=(g=e==null?void 0:e.map)==null?void 0:g.pin)==null?void 0:p[o])==null?void 0:h.icon;return i&&(i=u.cloneElement(i,{style:{transform:"rotate(-45deg)"}})),n.jsx(oe,{...r,children:i})};E.propTypes={kind:a.string};const T=({...o})=>{var r;const e=u.useContext(s.ThemeContext);return n.jsx(f.Box,{...(r=e==null?void 0:e.map)==null?void 0:r.popup,...o})};window.console=console;const te=console.error,ne=["useLayoutEffect does nothing on the server, because its effect cannot"];console.error=function(e,...r){ne.some(i=>e.includes(i))||te(e,...r)},l.Cluster=z,l.Controls=L,l.LocationBounds=O,l.Map=Z,l.Marker=D,l.MarkerCluster=I,l.Pin=E,l.Popup=T,l.base=N,l.normalizeTheme=S,Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})});
