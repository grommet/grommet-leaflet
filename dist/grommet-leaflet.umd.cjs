(function(l,n){typeof exports=="object"&&typeof module<"u"?n(exports,require("react/jsx-runtime"),require("react"),require("prop-types"),require("styled-components"),require("grommet"),require("grommet/utils"),require("/home/runner/work/grommet-leaflet/grommet-leaflet/node_modules/react-leaflet/lib/index.js"),require("/home/runner/work/grommet-leaflet/grommet-leaflet/node_modules/leaflet/dist/leaflet-src.js"),require("/home/runner/work/grommet-leaflet/grommet-leaflet/node_modules/grommet-icons/es6/index.js"),require("/home/runner/work/grommet-leaflet/grommet-leaflet/node_modules/protomaps/dist/protomaps.module.js"),require("/home/runner/work/grommet-leaflet/grommet-leaflet/node_modules/@react-leaflet/core/lib/index.js"),require("react-dom/server"),require("/home/runner/work/grommet-leaflet/grommet-leaflet/node_modules/uuid/dist/esm-browser/index.js"),require("/home/runner/work/grommet-leaflet/grommet-leaflet/node_modules/leaflet.markercluster/dist/leaflet.markercluster-src.js")):typeof define=="function"&&define.amd?define(["exports","react/jsx-runtime","react","prop-types","styled-components","grommet","grommet/utils","/home/runner/work/grommet-leaflet/grommet-leaflet/node_modules/react-leaflet/lib/index.js","/home/runner/work/grommet-leaflet/grommet-leaflet/node_modules/leaflet/dist/leaflet-src.js","/home/runner/work/grommet-leaflet/grommet-leaflet/node_modules/grommet-icons/es6/index.js","/home/runner/work/grommet-leaflet/grommet-leaflet/node_modules/protomaps/dist/protomaps.module.js","/home/runner/work/grommet-leaflet/grommet-leaflet/node_modules/@react-leaflet/core/lib/index.js","react-dom/server","/home/runner/work/grommet-leaflet/grommet-leaflet/node_modules/uuid/dist/esm-browser/index.js","/home/runner/work/grommet-leaflet/grommet-leaflet/node_modules/leaflet.markercluster/dist/leaflet.markercluster-src.js"],n):(l=typeof globalThis<"u"?globalThis:l||self,n(l["grommet-leaflet"]={},l.jsxRuntime,l.React,l.PropTypes,l.styled,l.grommet,l.utils,l.index_js,l.L,l.index_js$1,l.protomaps_module_js,l.index_js$2,l.ReactDOMServer,l.index_js$3))})(this,function(l,n,u,a,m,c,w,x,v,B,M,C,j,U){"use strict";const q=t=>{let e={};return t.forEach(r=>{e=w.deepMerge(e,r)}),e},Q=m(c.Box)`
  // translate to re-align with leaflet div
  transform: translateX(-35%);
  &:hover {
    transform: translateX(-35%) scale(1.1);
    transition: transform 0.4s;
  }
`,V=m(c.Text)`
  // multiplier of font-size, for tighter alignment
  line-height: 1rem;
`,S=({cluster:t,kind:e="default",size:r="medium",...i})=>{var f,p,g,h,D,I,W,X,A,K,J,F,H;const o=u.useContext(m.ThemeContext),s=q([(g=(p=(f=o==null?void 0:o.map)==null?void 0:f.cluster)==null?void 0:p.size)==null?void 0:g.medium,(I=(D=(h=o==null?void 0:o.map)==null?void 0:h.cluster)==null?void 0:D.size)==null?void 0:I[r],(X=(W=o==null?void 0:o.map)==null?void 0:W.cluster)==null?void 0:X.default,(K=(A=o==null?void 0:o.map)==null?void 0:A.cluster)==null?void 0:K[e]]),d=t.getChildCount(),k=(H=(F=(J=o==null?void 0:o.map)==null?void 0:J.cluster)==null?void 0:F[e])==null?void 0:H.icon,b=d;return n.jsxs(Q,{...s==null?void 0:s.container,...i,children:[k,n.jsx(V,{...s==null?void 0:s.label,children:b})]})};S.propTypes={cluster:a.object,kind:a.string,size:a.string};const T=({locations:t})=>{const e=v.latLngBounds();return t.features?t.features.forEach(r=>{var i,o;e.extend([(i=r.geometry)==null?void 0:i.coordinates[0],(o=r.geometry)==null?void 0:o.coordinates[1]])}):t.forEach(r=>{e.extend([r==null?void 0:r[0],r==null?void 0:r[1]])}),e},Y=1.5,O=({locations:t})=>{const e=x.useMap(),r=t&&T({locations:t}),[i,o]=u.useState(!1);return u.useEffect(()=>{r&&!i&&(JSON.stringify(r._northEast)===JSON.stringify(r._southWest)||e.flyToBounds(r,{duration:Y}))},[r,e,i]),u.useEffect(()=>{o(!0)},[]),n.jsx(c.Box,{className:"leaflet-bottom leaflet-right",children:n.jsx(c.Box,{className:"leaflet-control",children:n.jsxs(c.Box,{elevation:"large",round:"medium",background:"background",children:[n.jsx(c.Button,{a11yTitle:"Zoom in",icon:n.jsx(B.Add,{}),onClick:s=>{s.preventDefault(),e.zoomIn()}}),n.jsx(c.Button,{a11yTitle:"Zoom out",icon:n.jsx(B.Subtract,{}),onClick:s=>{s.preventDefault(),e.zoomOut()}}),n.jsx(c.Box,{border:{color:"border-weak",side:"top"},children:r&&n.jsx(c.Button,{a11yTitle:"Zoom to data",icon:n.jsx(B.Globe,{}),onClick:s=>{s.preventDefault(),e.flyToBounds(r,{duration:1.5})}})})]})})})};O.propTypes={locations:a.oneOfType([a.array,a.object])};const L={default:{container:{align:"center",justify:"center",background:"background-front",border:{color:"border",size:"small"},elevation:"medium",flex:!1,round:"full"}}},y={pin:{...w.deepMerge(L,{default:{container:{height:{min:"25px",max:"25px"},width:{min:"25px",max:"25px"}}}})},cluster:{...L,size:{small:{container:{height:{min:"36px",max:"36px"},width:{min:"36px",max:"36px"}},label:{size:"small"}},medium:{container:{direction:"row-reverse",gap:"xxsmall",height:{min:"48px",max:"48px"},width:{min:"48px",max:"48px"}},label:{color:"text-strong",size:"medium",weight:500}},large:{container:{direction:"row-reverse",gap:"xxsmall",height:{min:"54px",max:"54px"},width:{min:"54px",max:"54px"}},label:{size:"medium"}}}},popup:{background:"background-front",border:{color:"border-weak",size:"xsmall"},gap:"xsmall",margin:"none",pad:"small",round:"xsmall"},tiles:{}},$=({...t},e)=>{const r=M.leafletLayer({paint_rules:t.paintRules,...t});return C.createElementObject(r,e)},P=C.createTileLayerComponent($,C.updateGridLayer),N=({attribution:t,url:e,format:r,...i})=>{var d;const o=u.useContext(m.ThemeContext);let s=n.jsx(x.TileLayer,{attribution:t,url:e,...i});return r==="pmtiles"&&(s=n.jsx(P,{attribution:t,url:e,paintRules:((d=o.map)==null?void 0:d.tiles)&&M.paintRules({...M.light,...o.map.tiles}),...i})),s};N.propTypes={attribution:a.string,url:a.string.isRequired,format:a.oneOf(["pmtiles"])};const R=m(x.MapContainer)`
  ${({theme:t})=>{var e,r;return`
      ${(r=(e=t==null?void 0:t.global)==null?void 0:e.font)!=null&&r.family?`font-family: ${t.global.font.family};`:""}
      height: 100%;
    `}}
`,_=u.forwardRef(({center:t=[0,0],children:e,maxZoom:r=20,minZoom:i=3,scrollWheelZoom:o=!0,tileLayer:s,theme:d,zoom:k=1,zoomControl:b=!1,...f},p)=>{const g=u.useContext(m.ThemeContext),h=w.deepMerge(g,{map:w.deepMerge(y,d)});return n.jsx(m.ThemeContext.Provider,{value:h,children:n.jsxs(R,{attributionControl:!1,center:t,ref:p,scrollWheelZoom:o,maxZoom:r,minZoom:i,zoom:k,zoomControl:b,...f,children:[n.jsx(x.AttributionControl,{position:"bottomright",prefix:!1}),n.jsx(N,{attribution:s.attribution,url:s.url,format:s.format,...s}),e]})})});_.propTypes={center:a.array,children:a.any,scrollWheelZoom:a.string||a.bool,maxZoom:a.number,minZoom:a.number,tileLayer:a.shape({attribution:a.string,url:a.string.isRequired,format:a.oneOf(["pmtiles"])}).isRequired,theme:a.object,zoom:a.number,zoomControl:a.bool};const G=({icon:t,popup:e,...r})=>{var d;const i=u.useContext(m.ThemeContext),o=(d=t==null?void 0:t.props)==null?void 0:d.kind,s=e?n.jsx(x.Popup,{children:n.jsx(E,{children:e})}):void 0;return n.jsx(x.Marker,{icon:v.divIcon({className:"grommet-marker",html:j.renderToString(n.jsx(m.ThemeContext.Provider,{value:i,children:t||n.jsx(z,{})}))}),kind:o,...r,children:s},U.v4())};G.propTypes={icon:a.node,popup:a.node};const ee=({...t},e)=>{const r=new v.MarkerClusterGroup({showCoverageOnHover:!1,zoomToBoundsOnClick:!1,...t});return C.createElementObject(r,C.extendContext(e,{layerContainer:r}))},re=C.createPathComponent(ee),Z=({icon:t,popup:e,...r})=>{const i=u.useContext(m.ThemeContext);return n.jsx(re,{iconCreateFunction:o=>{if(e){const s=o.bindPopup(j.renderToString(n.jsx(m.ThemeContext.Provider,{value:i,children:n.jsx(E,{children:e({cluster:o})})})));o.on("click",()=>{s.openPopup()})}return v.divIcon({className:"grommet-cluster-group",html:j.renderToString(n.jsx(m.ThemeContext.Provider,{value:i,children:t?u.cloneElement(t({cluster:o}),{cluster:o}):n.jsx(S,{cluster:o})}))})},...r})};Z.propTypes={icon:a.func,popup:a.func};const te=m(c.Box)`
  // to create the pin shape
  border-bottom-right-radius: 0;
  // translate to re-align with leaflet div
  transform: rotate(45deg) translateX(-35%);
  &:hover {
    transform: rotate(45deg) translateX(-35%) scale(1.1);
    transition: transform 0.4s;
  }
`,z=({kind:t="default"})=>{var o,s,d,k,b,f,p,g,h;const e=u.useContext(m.ThemeContext),r=q([(d=(s=(o=e==null?void 0:e.map)==null?void 0:o.pin)==null?void 0:s.default)==null?void 0:d.container,(f=(b=(k=e==null?void 0:e.map)==null?void 0:k.pin)==null?void 0:b[t])==null?void 0:f.container]);let i=(h=(g=(p=e==null?void 0:e.map)==null?void 0:p.pin)==null?void 0:g[t])==null?void 0:h.icon;return i&&(i=u.cloneElement(i,{style:{transform:"rotate(-45deg)"}})),n.jsx(te,{...r,children:i})};z.propTypes={kind:a.string};const E=({...t})=>{var r;const e=u.useContext(m.ThemeContext);return n.jsx(c.Box,{...(r=e==null?void 0:e.map)==null?void 0:r.popup,...t})};window.console=console;const oe=console.error,ne=["useLayoutEffect does nothing on the server, because its effect cannot"];console.error=function(e,...r){ne.some(i=>e.includes(i))||oe(e,...r)},l.Cluster=S,l.Controls=O,l.LocationBounds=T,l.Map=_,l.Marker=G,l.MarkerCluster=Z,l.Pin=z,l.Popup=E,l.base=y,l.normalizeTheme=q,Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})});
